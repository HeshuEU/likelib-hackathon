syntax = "proto3";

// Cross platform definitions
option java_multiple_files = true;
option java_package = "by.heshu.likelib.rpc";
option java_outer_classname = "LikelibNodeProto";
option objc_class_prefix = "LKL";

// Service and messages definitions
package likelib;

service NodePublicInterface {
    rpc test (TestRequest) returns (TestResponse) {
    }

    rpc balance (Address) returns (Money) {
    }

    rpc transaction_to_contract (TransactionToContractRequest) returns (TransactionToContractResponse) {
    }

    rpc transaction_for_create_contract (TransactionCreationContractRequest) returns (TransactionCreationContractResponse) {
    }

    rpc transaction_to_wallet (TransactionToAccountRequest) returns (TransactionToAccountResponse) {
    }
}

message TestRequest {
    uint32 interface_version = 1;
}

message TestResponse {
    OperationStatus status = 1;
}

message TransactionToContractRequest {
    Money value = 1;
    Address from = 2;
    Address to = 3;
    Money gas = 4;
    Time creation_time = 5;
    MessageToContract contract_request = 6;
}

message TransactionToContractResponse {
    OperationStatus status = 1;
    Money gas_left = 2;
    MessageFromContract contract_response = 3;
}

message TransactionCreationContractRequest {
    Money value = 1;
    Address from = 2;
    Contract contract = 3;
    Money gas = 4;
    MessageToContract initial_message = 5;
    Time creation_time = 6;
}

message TransactionCreationContractResponse {
    OperationStatus status = 1;
    Money gas_left = 2;
    Address contract_address_at_hex = 3;
}

message TransactionToAccountRequest {
    Money value = 1;
    Address from = 2;
    Address to = 3;
    Time creation_time = 4;
}

message TransactionToAccountResponse {
    OperationStatus status = 1;
}

message MessageToContract {
    string message_at_hex = 1;
}

message MessageFromContract {
    string message_at_hex = 1;
}

message Contract {
    uint32 revision = 1;
    string bytecode_at_hex = 2;
}

message Time {
    uint32 day_grigorian = 1;
    uint32 month_grigorian = 2;
    uint32 year_grigorian = 3;
    uint32 hour_utc0 = 4;
    uint32 minute_utc0 = 5;
    uint32 second_utc0 = 6;
}

message Money {
    uint64 money = 1;
}

message Address {
    string address_at_hex = 1;
}

message OperationStatus {
    enum StatusCode {
        Success = 0;
        Rejected = 1;
        Failed = 2;
    }
    StatusCode status = 1;
    string message = 2;
}